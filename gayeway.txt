Spring Cloud Gateway (WebFlux tabanlÄ±) sana ÅŸunlarÄ± reactive ÅŸekilde ekleme imkÃ¢nÄ± verir:

*Authentication / Authorization
*Rate Limiting (Ã¶r. RedisReactiveRateLimiter)
*Logging, tracing, monitoring
*Request/Response manipulation


WebFluxâ€™in olayÄ± ÅŸu:

Bir request cevabÄ± beklenirken thread bloklanmaz.
AynÄ± thread o sÄ±rada baÅŸka bir requestâ€™i iÅŸleyebilir.
Yani klasik blocking servlet modelinde:
1 request = 1 thread â†’ cevap dÃ¶nene kadar o thread kitlenir.
WebFluxâ€™te:
1 thread = birÃ§ok request â†’ cevap gelmese bile thread boÅŸa beklemez, baÅŸka iÅŸi alÄ±r.

---------------------------------------

Keycloak Nedir?

Keycloak, aÃ§Ä±k kaynaklÄ± bir kimlik ve eriÅŸim yÃ¶netim sistemi (Identity and Access Management â€“ IAM)â€™dir.
Yani uygulamalarÄ±nda giriÅŸ (login), kayÄ±t (signup), yetkilendirme (authorization) gibi iÅŸleri senin yerine halleder.

Ne Ä°ÅŸe Yarar?

Login & Logout: KullanÄ±cÄ±larÄ±n sisteme giriÅŸ/Ã§Ä±kÄ±ÅŸ yapmasÄ±nÄ± saÄŸlar.
SSO (Single Sign-On): Bir kere giriÅŸ yapan kullanÄ±cÄ±, tÃ¼m baÄŸlÄ± uygulamalara tekrar ÅŸifre girmeden eriÅŸebilir.

KullanÄ±cÄ± YÃ¶netimi: KullanÄ±cÄ±larÄ±, rollerini (role), yetkilerini yÃ¶netebilirsin.
OAuth2, OpenID Connect, SAML desteÄŸi: Modern gÃ¼venlik protokollerini hazÄ±r saÄŸlar.

Social Login: Google, Facebook, GitHub gibi hesaplarla giriÅŸ yapÄ±lmasÄ±nÄ± kolayca ekleyebilirsin.

https://www.keycloak.org/
-----------------------------------------

Realm Nedir?

Keycloakâ€™ta realm, kullanÄ±cÄ±larÄ±, rollerini, gruplarÄ±nÄ± ve istemcilerini (clients) yÃ¶nettiÄŸin izole bir gÃ¼venlik alanÄ±dÄ±r.

Bunu ÅŸÃ¶yle dÃ¼ÅŸÃ¼nebilirsin:
Realm = ayrÄ± bir gÃ¼venlik evreni / domain.

Bir realm iÃ§indeki kullanÄ±cÄ±lar, roller ve uygulamalar baÅŸka bir realm ile karÄ±ÅŸmaz.

-------------------------------------------
Ne Ä°ÅŸe Yarar?

KullanÄ±cÄ±larÄ± tanÄ±mlarsÄ±n (username, password).
Rolleri tanÄ±mlarsÄ±n (admin, user, customer vs.).
Ä°stemcileri (Spring Boot uygulamalarÄ±, frontend uygulamalarÄ±) kaydedersin.
O realmâ€™in kurallarÄ±na gÃ¶re kimlik doÄŸrulama ve yetkilendirme yapÄ±lÄ±r.

Client = UygulamanÄ±n Keycloakâ€™taki temsilcisi
Uygulaman â†’ Client ID ve Secret ile â†’ Keycloakâ€™tan Access Token / ID Token alÄ±r.
Token ile kullanÄ±cÄ± kimliÄŸi ve rolleri servislerine taÅŸÄ±nÄ±r.

------------------------------------------------
Client authentication" (ON / OFF) Ne Demek?

Bu ayar aslÄ±nda OIDC client tipini belirler:
ON (Confidential Client)
UygulamanÄ±n (client) Keycloakâ€™a eriÅŸirken client secret (ÅŸifre) kullanmasÄ± gerekir.
Daha gÃ¼venlidir Ã§Ã¼nkÃ¼ sadece uygulama + Keycloak bilir.
Genelde backend servisler (Spring Boot API, microservice) iÃ§in kullanÄ±lÄ±r.

Ã–rn: API Gateway â†’ Keycloakâ€™tan token alÄ±rken clientId + clientSecret gÃ¶nderir.

OFF (Public Client)
Client secret yoktur.
Daha az gÃ¼venlidir Ã§Ã¼nkÃ¼ herkes eriÅŸebilir (secret olmadÄ±ÄŸÄ± iÃ§in saklayacak bir ÅŸey yok).
Genelde frontend uygulamalar (React, Angular, mobil app) iÃ§in kullanÄ±lÄ±r.

Ã–rn: Bir React uygulamasÄ± tarayÄ±cÄ±da Ã§alÄ±ÅŸtÄ±ÄŸÄ± iÃ§in secret saklayamaz â†’ public client olur.

------------------------------------------------

1. Direct Access Grants

(= OAuth2 Resource Owner Password Credentials Grant)
Kim var? â†’ KullanÄ±cÄ± var.
KullanÄ±cÄ±, username + password bilgisini doÄŸrudan client uygulamasÄ±na verir.
Client bu bilgiyi Keycloakâ€™a gÃ¶nderir â†’ Keycloak doÄŸrular â†’ kullanÄ±cÄ± adÄ±na access token dÃ¶ner.
Token, kullanÄ±cÄ±nÄ±n rolleri/izinleri ile gelir.

ğŸ“Œ KullanÄ±m AlanÄ±:
Postman ile test yaparken hÄ±zlÄ± token almak.
Mobil app veya trusted uygulama senaryolarÄ±.
âš ï¸ Eksisi: KullanÄ±cÄ± ÅŸifresi clientâ€™a verildiÄŸi iÃ§in gÃ¼venlik zayÄ±f. ArtÄ±k productionâ€™da pek Ã¶nerilmez.

ğŸ”‘ 2. Service Accounts Roles

(= OAuth2 Client Credentials Grant)

Kim var? â†’ KullanÄ±cÄ± yok, sadece client var.
Client (Ã¶r. inventory-service) kendi clientId + clientSecret bilgisiyle Keycloakâ€™a gider.
Keycloak â†’ client iÃ§in access token Ã¼retir.
Bu token bir kullanÄ±cÄ±ya deÄŸil, client uygulamaya aittir.

ğŸ“Œ KullanÄ±m AlanÄ±:

Mikroservisler arasÄ± iletiÅŸim (M2M).
Arka plan servisleri, cron jobâ€™lar, batch iÅŸlemleri.


------------------------------------

Senaryoyu sade ÅŸekilde Ã¶zetleyeyim:

Gateway, Keycloakâ€™ta tanÄ±mlÄ± bir client olarak kayÄ±tlÄ±dÄ±r (clientId, clientSecret var).
Gateway, Keycloakâ€™tan Service Account (client credentials) ile token alÄ±r.

Burada kullanÄ±cÄ± yok, tamamen gatewayâ€™in kendi kimliÄŸi.
Bu aldÄ±ÄŸÄ± access token ile arka plandaki microserviceâ€™lere (order-service, product-service vs.) eriÅŸir.
Servisler de gelen tokenâ€™Ä± doÄŸrular â†’ â€œBu istek gerÃ§ekten gÃ¼venilir bir clientâ€™tan mÄ± geliyor?â€ diye.

âœ… BÃ¶ylece:

Gateway Keycloakâ€™tan aldÄ±ÄŸÄ± tokenâ€™la servislerin kapÄ±sÄ±nÄ± aÃ§ar.
KullanÄ±cÄ± adÄ±/ÅŸifreye gerek yoktur.
Servisler arasÄ± iletiÅŸim gÃ¼venli olur.

------------------------------------------
swagger

https://www.openapis.org/

https://springdoc.org/


